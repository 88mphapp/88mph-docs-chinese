<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Bacon Labs">
  <link rel="canonical" href="https://88mph.app/docs/smartcontract/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Smart contract reference - 88mph Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Smart contract reference";
    var mkdocs_page_input_path = "smartcontract.md";
    var mkdocs_page_url = "/docs/smartcontract/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> 88mph Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../howitworks/">How 88mph works</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Smart contract reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#mainnet-deployments">Mainnet deployments</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#architecture-overview">Architecture overview</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#api-reference">API reference</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#dinterest">DInterest</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#state-changing-functions">State changing functions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#read-only-functions">Read only functions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#feemodel">FeeModel</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#read-only-functions_1">Read only functions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#moneymarket">MoneyMarket</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#state-changing-functions_1">State changing functions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#read-only-functions_2">Read only functions</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">88mph Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Smart contract reference</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/88mphapp/docs/edit/master/docs/smartcontract.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="smart-contract-reference">Smart contract reference<a class="headerlink" href="#smart-contract-reference" title="Permanent link">#</a></h1>
<p>The smart contract source code can be found on <a href="https://github.com/Bacon-labs/88mph-contracts">GitHub</a>.</p>
<h2 id="mainnet-deployments">Mainnet deployments<a class="headerlink" href="#mainnet-deployments" title="Permanent link">#</a></h2>
<ul>
<li><code>DInterest</code>: <a href="https://etherscan.io/address/0x9b226970cdeAdA0026aEd50D02E4A0dD37C92b6F">0x9b226970cdeAdA0026aEd50D02E4A0dD37C92b6F</a></li>
<li><code>FeeModel</code>: <a href="https://etherscan.io/address/0xf1409a2f1F5f53e46BbAfd334311c80e675a410D">0xf1409a2f1F5f53e46BbAfd334311c80e675a410D</a></li>
<li><code>CompoundERC20Market</code>: <a href="https://etherscan.io/address/0xe7326dc7D136c6dF7A4056679A82aBd144631043">0xe7326dc7D136c6dF7A4056679A82aBd144631043</a></li>
</ul>
<h2 id="architecture-overview">Architecture overview<a class="headerlink" href="#architecture-overview" title="Permanent link">#</a></h2>
<p>88mph consists of 3 smart contracts:</p>
<ul>
<li><code>DInterest</code>: The main smart contract that users interact with. Handles depositing, withdrawing, and keeping track of deposits. Emits all of the events used in the subgraph.</li>
<li><code>FeeModel</code>: Determines the fee strategy of 88mph, as well as who receives the fees.</li>
<li><code>MoneyMarket</code>: A wrapper for interacting with money market protocols, and stores all of the user funds. Requires a different one for each money market protocol. As of now we have <code>CompoundERC20Market</code> and <code>AaveMarket</code> written.</li>
</ul>
<h2 id="api-reference">API reference<a class="headerlink" href="#api-reference" title="Permanent link">#</a></h2>
<h3 id="dinterest">DInterest<a class="headerlink" href="#dinterest" title="Permanent link">#</a></h3>
<h4 id="state-changing-functions">State changing functions<a class="headerlink" href="#state-changing-functions" title="Permanent link">#</a></h4>
<h5 id="function-deposituint256-amount-uint256-maturationtimestamp-external"><code>function deposit(uint256 amount, uint256 maturationTimestamp) external</code><a class="headerlink" href="#function-deposituint256-amount-uint256-maturationtimestamp-external" title="Permanent link">#</a></h5>
<p>Creates a single deposit for the caller.</p>
<ul>
<li><code>amount</code>: The amount of Dai to deposit. The caller should have already approved the contract to spend this much Dai before calling this function. Scaled by <script type="math/tex">10^{18}</script>.</li>
<li><code>maturationTimestamp</code>: The Unix timestamp at and after which the deposit will be able to be withdrawn. In seconds.</li>
</ul>
<h5 id="function-withdrawuint256-depositid-external"><code>function withdraw(uint256 depositID) external</code><a class="headerlink" href="#function-withdrawuint256-depositid-external" title="Permanent link">#</a></h5>
<p>Withdraws a single deposit for the caller.</p>
<ul>
<li><code>depositID</code>: The index of the deposit to be withdrawn in the <code>userDeposits</code> array.</li>
</ul>
<h5 id="function-multideposituint256-calldata-amountlist-uint256-calldata-maturationtimestamplist-external"><code>function multiDeposit(uint256[] calldata amountList, uint256[] calldata maturationTimestampList) external</code><a class="headerlink" href="#function-multideposituint256-calldata-amountlist-uint256-calldata-maturationtimestamplist-external" title="Permanent link">#</a></h5>
<p>Deposits multiple deposits for the caller. The values at each index in each array will be combined to create a single deposit.</p>
<ul>
<li><code>amountList</code>: An array of the amounts of Dai to deposit. The caller should have already approved the contract to spend this much Dai before calling this function. Scaled by <script type="math/tex">10^{18}</script>.</li>
<li><code>maturationTimestampList</code>: An array of the Unix timestamps at and after which the deposits will be able to be withdrawn. In seconds.</li>
</ul>
<h5 id="function-multiwithdrawuint256-calldata-depositidlist-external"><code>function multiWithdraw(uint256[] calldata depositIDList) external</code><a class="headerlink" href="#function-multiwithdrawuint256-calldata-depositidlist-external" title="Permanent link">#</a></h5>
<p>Withdraws multiple deposits for the caller.</p>
<ul>
<li><code>depositIDList</code>: The indices of the deposits to be withdrawn in the <code>userDeposits</code> array.</li>
</ul>
<h5 id="function-sponsordeposituint256-amount-uint256-maturationtimestamp-string-calldata-data-external"><code>function sponsorDeposit(uint256 amount, uint256 maturationTimestamp, string calldata data) external</code><a class="headerlink" href="#function-sponsordeposituint256-amount-uint256-maturationtimestamp-string-calldata-data-external" title="Permanent link">#</a></h5>
<p>Creates a single sponsor deposit for the caller.</p>
<ul>
<li><code>amount</code>: The amount of Dai to deposit. The caller should have already approved the contract to spend this much Dai before calling this function. Scaled by <script type="math/tex">10^{18}</script>.</li>
<li><code>maturationTimestamp</code>: The Unix timestamp at and after which the deposit will be able to be withdrawn. In seconds.</li>
<li><code>data</code>: An arbitrary string that contains metadata about the sponsor. Will be emitted as part of an event, but won't be put in storage.</li>
</ul>
<h5 id="function-sponsorwithdrawuint256-depositid-external"><code>function sponsorWithdraw(uint256 depositID) external</code><a class="headerlink" href="#function-sponsorwithdrawuint256-depositid-external" title="Permanent link">#</a></h5>
<p>Withdraws a single sponsor deposit for the caller.</p>
<ul>
<li><code>depositID</code>: The index of the deposit to be withdrawn in the <code>sponsorDeposits</code> array.</li>
</ul>
<h4 id="read-only-functions">Read only functions<a class="headerlink" href="#read-only-functions" title="Permanent link">#</a></h4>
<h5 id="function-userdepositsaddress-user-uint256-depositid-external-view-returns-uint256-amount-uint256-maturationtimestamp-bool-active"><code>function userDeposits(address user, uint256 depositID) external view returns (uint256 amount, uint256 maturationTimestamp, bool active)</code><a class="headerlink" href="#function-userdepositsaddress-user-uint256-depositid-external-view-returns-uint256-amount-uint256-maturationtimestamp-bool-active" title="Permanent link">#</a></h5>
<p>Returns info about a user deposit.</p>
<h6 id="inputs">Inputs<a class="headerlink" href="#inputs" title="Permanent link">#</a></h6>
<ul>
<li><code>user</code>: The address of the user.</li>
<li><code>depositID</code>: The index of the deposit in the <code>userDeposits</code> array.</li>
</ul>
<h6 id="returns">Returns<a class="headerlink" href="#returns" title="Permanent link">#</a></h6>
<ul>
<li><code>amount</code>: The amount of the deposit, in stablecoins. Scaled by <script type="math/tex">10^{stablecoinDecimals}</script>.</li>
<li><code>maturationTimestamp</code>: The Unix timestamp at and after which the deposit will be able to be withdrawn. In seconds.</li>
<li><code>active</code>: <code>true</code> if the deposit hasn't been withdrawn, <code>false</code> otherwise.</li>
</ul>
<h5 id="function-sponsordepositsaddress-user-uint256-depositid-external-view-returns-uint256-amount-uint256-maturationtimestamp-bool-active"><code>function sponsorDeposits(address user, uint256 depositID) external view returns (uint256 amount, uint256 maturationTimestamp, bool active)</code><a class="headerlink" href="#function-sponsordepositsaddress-user-uint256-depositid-external-view-returns-uint256-amount-uint256-maturationtimestamp-bool-active" title="Permanent link">#</a></h5>
<p>Returns info about a sponsor deposit.</p>
<h6 id="inputs_1">Inputs<a class="headerlink" href="#inputs_1" title="Permanent link">#</a></h6>
<ul>
<li><code>user</code>: The address of the sponsor.</li>
<li><code>depositID</code>: The index of the deposit in the <code>sponsorDeposits</code> array.</li>
</ul>
<h6 id="returns_1">Returns<a class="headerlink" href="#returns_1" title="Permanent link">#</a></h6>
<ul>
<li><code>amount</code>: The amount of the deposit, in stablecoins. Scaled by <script type="math/tex">10^{stablecoinDecimals}</script>.</li>
<li><code>maturationTimestamp</code>: The Unix timestamp at and after which the deposit will be able to be withdrawn. In seconds.</li>
<li><code>active</code>: <code>true</code> if the deposit hasn't been withdrawn, <code>false</code> otherwise.</li>
</ul>
<h5 id="function-uirmultiplier-external-view-returns-uint256"><code>function UIRMultiplier() external view returns (uint256)</code><a class="headerlink" href="#function-uirmultiplier-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the multiplier <script type="math/tex">m</script> used <a href="../howitworks/#technical-details">here</a>. Scaled by <script type="math/tex">10^{18}</script>.</p>
<h5 id="function-mindepositperiod-external-view-returns-uint256"><code>function MinDepositPeriod() external view returns (uint256)</code><a class="headerlink" href="#function-mindepositperiod-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the minimum deposit period, in seconds.</p>
<h5 id="function-totaldeposit-external-view-returns-uint256"><code>function totalDeposit() external view returns (uint256)</code><a class="headerlink" href="#function-totaldeposit-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the total deposited amount of <code>stablecoin</code>. Scaled by <script type="math/tex">10^{stablecoinDecimals}</script>.</p>
<h5 id="function-moneymarket-external-view-returns-address"><code>function moneyMarket() external view returns (address)</code><a class="headerlink" href="#function-moneymarket-external-view-returns-address" title="Permanent link">#</a></h5>
<p>Returns the address of <code>MoneyMarket</code>.</p>
<h5 id="function-stablecoin-external-view-returns-address"><code>function stablecoin() external view returns (address)</code><a class="headerlink" href="#function-stablecoin-external-view-returns-address" title="Permanent link">#</a></h5>
<p>Returns the address of the stablecoin used.</p>
<h5 id="function-feemodel-external-view-returns-address"><code>function feeModel() external view returns (address)</code><a class="headerlink" href="#function-feemodel-external-view-returns-address" title="Permanent link">#</a></h5>
<p>Returns the address of <code>FeeModel</code>.</p>
<h5 id="function-calculateupfrontinterestrateuint256-depositperiodinseconds-external-view-returns-uint256-upfrontinterestrate"><code>function calculateUpfrontInterestRate(uint256 depositPeriodInSeconds) external view returns (uint256 upfrontInterestRate)</code><a class="headerlink" href="#function-calculateupfrontinterestrateuint256-depositperiodinseconds-external-view-returns-uint256-upfrontinterestrate" title="Permanent link">#</a></h5>
<p>Returns the current upfront interest rate <script type="math/tex">\gamma</script> used <a href="../howitworks/#technical-details">here</a>.</p>
<h6 id="inputs_2">Inputs<a class="headerlink" href="#inputs_2" title="Permanent link">#</a></h6>
<ul>
<li><code>depositPeriodInSeconds</code>: The length of the deposit's deposit period, in seconds.</li>
</ul>
<h5 id="function-blocktime-external-view-returns-uint256"><code>function blocktime() external view returns (uint256)</code><a class="headerlink" href="#function-blocktime-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the average block time 88mph uses in its upfront interest rate calculation, in seconds. Scaled by <script type="math/tex">10^{18}</script>.</p>
<h5 id="function-deficit-external-view-returns-bool-isnegative-uint256-deficitamount"><code>function deficit() external view returns (bool isNegative, uint256 deficitAmount)</code><a class="headerlink" href="#function-deficit-external-view-returns-bool-isnegative-uint256-deficitamount" title="Permanent link">#</a></h5>
<p>Returns the deficit of the pool.</p>
<h6 id="returns_2">Returns<a class="headerlink" href="#returns_2" title="Permanent link">#</a></h6>
<ul>
<li><code>isNegative</code>: Whether the deficit is negative. A negative deficit means there's a surplus.</li>
<li><code>deficitAmount</code>: Amount of the pool's deficit, in stablecoins. Scaled by <script type="math/tex">10^{stablecoinDecimals}</script>.</li>
</ul>
<h3 id="feemodel">FeeModel<a class="headerlink" href="#feemodel" title="Permanent link">#</a></h3>
<h4 id="read-only-functions_1">Read only functions<a class="headerlink" href="#read-only-functions_1" title="Permanent link">#</a></h4>
<h5 id="function-getfeeuint256-_txamount-external-pure-returns-uint256-_feeamount"><code>function getFee(uint256 _txAmount) external pure returns (uint256 _feeAmount)</code><a class="headerlink" href="#function-getfeeuint256-_txamount-external-pure-returns-uint256-_feeamount" title="Permanent link">#</a></h5>
<p>Used for determining how much fee to charge from a transaction.</p>
<h6 id="inputs_3">Inputs<a class="headerlink" href="#inputs_3" title="Permanent link">#</a></h6>
<ul>
<li><code>_txAmount</code>: The amount of the transaction from which a fee will be taken.</li>
</ul>
<h6 id="returns_3">Returns<a class="headerlink" href="#returns_3" title="Permanent link">#</a></h6>
<ul>
<li><code>_feeAmount</code>: The amount of the fee that will be taken from the transaction.</li>
</ul>
<h5 id="function-beneficiary-external-view-returns-address"><code>function beneficiary() external view returns (address)</code><a class="headerlink" href="#function-beneficiary-external-view-returns-address" title="Permanent link">#</a></h5>
<p>Returns the address who will receive the fees.</p>
<h3 id="moneymarket">MoneyMarket<a class="headerlink" href="#moneymarket" title="Permanent link">#</a></h3>
<h4 id="state-changing-functions_1">State changing functions<a class="headerlink" href="#state-changing-functions_1" title="Permanent link">#</a></h4>
<h5 id="function-deposituint256-amount-external"><code>function deposit(uint256 amount) external</code><a class="headerlink" href="#function-deposituint256-amount-external" title="Permanent link">#</a></h5>
<p>Lends <code>amount</code> stablecoins to the underlying money market protocol.</p>
<h6 id="inputs_4">Inputs<a class="headerlink" href="#inputs_4" title="Permanent link">#</a></h6>
<ul>
<li><code>amount</code>: The amount of stablecoins to be deposited.</li>
</ul>
<h5 id="function-withdrawuint256-amountinunderlying-external"><code>function withdraw(uint256 amountInUnderlying) external</code><a class="headerlink" href="#function-withdrawuint256-amountinunderlying-external" title="Permanent link">#</a></h5>
<p>Withdraws <code>amountInUnderlying</code> stablecoins from the underlying money market protocol.</p>
<h6 id="inputs_5">Inputs<a class="headerlink" href="#inputs_5" title="Permanent link">#</a></h6>
<ul>
<li><code>amountInUnderlying</code>: The amount of stablecoins to be withdrawn.</li>
</ul>
<h4 id="read-only-functions_2">Read only functions<a class="headerlink" href="#read-only-functions_2" title="Permanent link">#</a></h4>
<h5 id="function-supplyrateperseconduint256-blocktime-external-view-returns-uint256"><code>function supplyRatePerSecond(uint256 blocktime) external view returns (uint256)</code><a class="headerlink" href="#function-supplyrateperseconduint256-blocktime-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the current interest rate offered by the money market, per second. Scaled by <script type="math/tex">10^{18}</script>.</p>
<h6 id="inputs_6">Inputs<a class="headerlink" href="#inputs_6" title="Permanent link">#</a></h6>
<ul>
<li><code>blocktime</code>: The average block time, in seconds. Scaled by <script type="math/tex">10^{18}</script>.</li>
</ul>
<h5 id="function-totalvalue-external-view-returns-uint256"><code>function totalValue() external view returns (uint256)</code><a class="headerlink" href="#function-totalvalue-external-view-returns-uint256" title="Permanent link">#</a></h5>
<p>Returns the total value locked in the money market, in terms of the underlying stablecoin. Scaled by <script type="math/tex">10^{stablecoinDecimals}</script>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../howitworks/" class="btn btn-neutral" title="How 88mph works"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/88mphapp/docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../howitworks/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
